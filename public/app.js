(()=>{"use strict";var t=function(){function t(t){this.m_mmu=t,this.P1=65280,this.DIV=65283,this.TIMA=65285,this.TMA=65286,this.TAC=65287,this.IF=65295,this.IE=65535,this.m_instructionMethods1=[this.LD_R_to_R],this.m_jstate1=0,this.m_jstate2=0,this.m_BIOSMapped=!0,this.m_PC=0,this.m_SP=0,this.m_clock=0,this.IME=!1,this.m_cbPrefix=!1,this.m_isHalted=!1,this.m_falligEdgeDelay=!1}return t.prototype.step=function(){16&this.m_mmu.read(this.P1)?this.m_mmu.write(this.P1,this.P1|this.m_jstate2):this.m_mmu.write(this.P1,this.P1|this.m_jstate1),0==this.m_clock?(this.getInput(),this.m_clock=1e3):this.m_clock-=1,this.updateTimer(),this.checkForInterupts(),this.m_isHalted||(console.log(this.m_clock),console.log(this.m_mmu),console.log(this.m_mmu.read(this.m_PC)),0==this.m_clock&&this.execute(this.m_mmu.read(this.m_PC)),this.m_clock-=1)},t.prototype.getInput=function(){},t.prototype.execute=function(t){256==this.m_PC&&(this.m_BIOSMapped=!1);var i=(192&t)>>6,s=(56&t)>>3,m=7&t;this.m_instructionMethods1[t](i,s,m),this.m_PC+=1,this.IME,this.m_SP,this.m_cbPrefix,this.m_falligEdgeDelay},t.prototype.updateTimer=function(){},t.prototype.checkForInterupts=function(){},t.prototype.LD_R_to_R=function(t,i,s){},t}(),i=function(){function t(t,i){this.m_mmu=t,this.m_frame=i,this.m_mmu,this.m_frame}return t.prototype.step=function(){},t}(),s=function(){function t(){this.m_addrBus=Array(65535).fill(0)}return t.prototype.read=function(t){return this.m_addrBus[65535&t]},t.prototype.write=function(t,i){this.m_addrBus[65535&t]=255&i},t}(),m=function(){function m(m){this.m_path=m,this.m_frame=[23040].fill(0),this.m_mmu=new s,this.m_cpu=new t(this.m_mmu),this.m_gpu=new i(this.m_mmu,this.m_frame),this.m_inVBLANK=!1,this.m_cpu,this.m_gpu,this.m_inVBLANK}return m.prototype.getFrame=function(){for(var t=0;t<100;t++)this.m_cpu.step(),this.m_gpu.step();return this.m_frame},m}(),e=document.getElementById("canvas").getContext("2d"),h=e.createImageData(160,144),n=0,o=new m("TBD");setInterval((function(){var t=h.data;t[4*n]=255,t[4*n+3]=255,e.putImageData(h,0,0),n+=1}),1e3/60),setInterval((function(){o.getFrame()}),1e3/60)})();